version: 1.0
runtime: nodejs20 # Or the Node.js version you intend to use (e.g., nodejs18)

build:
  commands:
    pre-build:
      # Install backend dependencies
      - echo "Installing root dependencies..."
      - npm install
      # Install client dependencies and build the client
      - echo "Installing client dependencies..."
      - cd src/client
      - npm install
      - echo "Building client..."
      - npm run build
      - cd ../..
    build:
      # No specific build command needed for the backend if not using TypeScript/bundling
      - echo "Build step complete (client built in pre-build)"

run:
  # Command to start the Node.js server
  command: node src/server.js
  # Network port the application listens on
  port: 3001 # Ensure this matches the PORT in your .env or server default

# Optional: Define environment variables here if NOT sensitive
# environment_variables:
#   MY_VAR: "my_value"

# Note: Sensitive environment variables (like database keys) should be passed
# during the 'aws apprunner create-service' command or configured in the console,
# NOT stored directly in this file. 